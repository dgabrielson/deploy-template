==================================
mail - Full stack mailsystem
==================================

Hostname:
    ``mail.example.com`` (internal only)
VM network IP:
    192.168.1.30
Hosted on:
    ``kvm0``
Operating system:
    Ubuntu LTS


Purpose
---------

Provide mail services for the cluster.  

This mail system is the hub for mail delivery for the entire cluster.
It will deliver to local accounts, as well as relay mail through
the UofM Exchange email system to the outside world.

This system is designed and deployed for maximum expandability, 
specifically so that if the department chooses in the future
to launch a public "mail.example.com" system, this VM
will do the job.


Accounts and Passwords
------------------------

Email accounts and passwords are handled by configuration files.
These files and the contents of ``/var/mail`` on the system represent
the full extent of server data which must be backed up or ported
to a new instance.

``example-deploy/mail/accounts/accounts.cf``
    Actual user accounts.
    
    The format of this file is::
    
        user@example.com|{METHOD}passwordhash
        
    Users log in using the full email address as a username in this system.
    
    The ``METHOD`` must be supported by dovecot: run ``doveadm pw -l``
    for  list of available methods.
    The second part (after the pipe character) is a password method and hash 
    as generated by the command ``doveadm pw -s METHOD``.  
    
``example-deploy/mail/accounts/aliases.cf``
    Mail redirection aliases.

``example-deploy/mail/accounts/regexp.cf``
    Mail redirection aliases as regular expressions.

The directory ``example-deploy/mail/accounts`` has examples and more 
information on these files, as well as the ``Makefile`` that
will process these configuration files and make them live for
the mail system.


Services
---------

postfix
    mail transfer agent (MTA) that routes and delivers electronic mail.

dovecot
    IMAP and POP3 server for Linux/UNIX-like systems.  (POP3 disabled.)
    
amavis
    content filter for electronic mail.
    
spamassassin
    e-mail spam filtering.
    
postgrey
    a Postfix policy server implementing greylisting.
    


